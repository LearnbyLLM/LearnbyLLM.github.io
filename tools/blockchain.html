<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Understanding Blockchain - Interactive Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0d1117 0%, #161b22 50%, #0d1117 100%);
            min-height: 100vh;
            color: #e6edf3;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            padding: 50px 20px;
            background: linear-gradient(180deg, rgba(56, 139, 253, 0.1) 0%, transparent 100%);
            border-bottom: 1px solid #30363d;
            position: relative;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 600px;
            height: 300px;
            background: radial-gradient(ellipse, rgba(56, 139, 253, 0.15) 0%, transparent 70%);
            pointer-events: none;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(90deg, #58a6ff, #bf91f7, #f778ba);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
        }

        .header p {
            color: #8b949e;
            font-size: 1.2rem;
            position: relative;
        }

        .nav-tabs {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            padding: 20px;
            background: rgba(22, 27, 34, 0.8);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid #30363d;
        }

        .nav-tab {
            padding: 10px 20px;
            border: 1px solid #30363d;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            background: transparent;
            color: #8b949e;
        }

        .nav-tab:hover {
            background: #21262d;
            color: #e6edf3;
            border-color: #8b949e;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #238636, #2ea043);
            border-color: #238636;
            color: #fff;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
        }

        .section {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: #161b22;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid #30363d;
        }

        .card h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: #58a6ff;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card h3 {
            font-size: 1.2rem;
            margin: 25px 0 12px;
            color: #bf91f7;
        }

        .description {
            color: #8b949e;
            line-height: 1.8;
            margin-bottom: 20px;
            font-size: 1.05rem;
        }

        .interactive-area {
            background: #0d1117;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            border: 1px solid #30363d;
        }

        .info-box {
            background: rgba(56, 139, 253, 0.1);
            border-left: 4px solid #58a6ff;
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
        }

        .info-box.warning {
            background: rgba(210, 153, 34, 0.1);
            border-left-color: #d29922;
        }

        .info-box.success {
            background: rgba(46, 160, 67, 0.1);
            border-left-color: #2ea043;
        }

        .info-box.danger {
            background: rgba(248, 81, 73, 0.1);
            border-left-color: #f85149;
        }

        .info-box h4 {
            color: #58a6ff;
            margin-bottom: 8px;
        }

        .info-box.warning h4 { color: #d29922; }
        .info-box.success h4 { color: #2ea043; }
        .info-box.danger h4 { color: #f85149; }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: #238636;
            color: #fff;
        }

        .btn-primary:hover {
            background: #2ea043;
        }

        .btn-secondary {
            background: #21262d;
            color: #e6edf3;
            border: 1px solid #30363d;
        }

        .btn-secondary:hover {
            background: #30363d;
        }

        .btn-danger {
            background: #da3633;
            color: #fff;
        }

        .btn-danger:hover {
            background: #f85149;
        }

        input, textarea {
            padding: 12px 16px;
            border: 1px solid #30363d;
            border-radius: 8px;
            background: #0d1117;
            color: #e6edf3;
            font-size: 1rem;
            font-family: inherit;
            width: 100%;
            transition: border-color 0.2s;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #58a6ff;
        }

        input::placeholder, textarea::placeholder {
            color: #484f58;
        }

        /* Hash Visualization */
        .hash-demo {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .hash-input-section {
            display: flex;
            gap: 15px;
            align-items: flex-start;
        }

        .hash-input-section input {
            flex: 1;
        }

        .hash-output {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', 'Monaco', monospace;
            word-break: break-all;
            position: relative;
        }

        .hash-output .label {
            position: absolute;
            top: -10px;
            left: 15px;
            background: #161b22;
            padding: 0 8px;
            font-size: 0.8rem;
            color: #8b949e;
        }

        .hash-value {
            color: #7ee787;
            font-size: 1.1rem;
            letter-spacing: 1px;
        }

        .hash-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .hash-compare-box {
            background: #0d1117;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #30363d;
        }

        .hash-compare-box.match {
            border-color: #2ea043;
        }

        .hash-compare-box.no-match {
            border-color: #f85149;
        }

        /* Block Visualization */
        .block {
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            border: 2px solid #30363d;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .block.valid {
            border-color: #2ea043;
            box-shadow: 0 0 20px rgba(46, 160, 67, 0.2);
        }

        .block.invalid {
            border-color: #f85149;
            box-shadow: 0 0 20px rgba(248, 81, 73, 0.2);
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .block-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #30363d;
        }

        .block-number {
            font-size: 1.3rem;
            font-weight: bold;
            color: #58a6ff;
        }

        .block-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .block-status.valid {
            background: rgba(46, 160, 67, 0.2);
            color: #2ea043;
        }

        .block-status.invalid {
            background: rgba(248, 81, 73, 0.2);
            color: #f85149;
        }

        .block-field {
            margin: 12px 0;
        }

        .block-field label {
            display: block;
            font-size: 0.85rem;
            color: #8b949e;
            margin-bottom: 5px;
        }

        .block-field input {
            font-family: 'Consolas', monospace;
        }

        .block-field .hash-display {
            background: #0d1117;
            padding: 10px 15px;
            border-radius: 6px;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            color: #7ee787;
            word-break: break-all;
            border: 1px solid #30363d;
        }

        .block-field .hash-display.prev-hash {
            color: #f778ba;
        }

        /* Chain Visualization */
        .chain-container {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 20px 0;
            align-items: center;
        }

        .chain-block {
            min-width: 200px;
            background: #21262d;
            border: 2px solid #30363d;
            border-radius: 10px;
            padding: 15px;
            flex-shrink: 0;
            transition: all 0.3s ease;
        }

        .chain-block.valid {
            border-color: #2ea043;
        }

        .chain-block.invalid {
            border-color: #f85149;
        }

        .chain-block.genesis {
            border-color: #58a6ff;
            background: linear-gradient(135deg, rgba(56, 139, 253, 0.1), #21262d);
        }

        .chain-link {
            font-size: 2rem;
            color: #30363d;
        }

        .chain-link.valid {
            color: #2ea043;
        }

        .chain-link.invalid {
            color: #f85149;
        }

        .mini-hash {
            font-family: 'Consolas', monospace;
            font-size: 0.75rem;
            color: #7ee787;
            word-break: break-all;
        }

        .mini-hash.prev {
            color: #f778ba;
        }

        /* Mining Visualization */
        .mining-container {
            text-align: center;
        }

        .mining-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .mining-stat {
            background: #0d1117;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #30363d;
        }

        .mining-stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #58a6ff;
            font-family: 'Consolas', monospace;
        }

        .mining-stat-label {
            font-size: 0.85rem;
            color: #8b949e;
            margin-top: 5px;
        }

        .nonce-display {
            font-family: 'Consolas', monospace;
            font-size: 2rem;
            color: #d29922;
            margin: 20px 0;
        }

        .mining-hash {
            font-family: 'Consolas', monospace;
            font-size: 1rem;
            padding: 15px;
            background: #0d1117;
            border-radius: 8px;
            margin: 15px 0;
            word-break: break-all;
            border: 1px solid #30363d;
        }

        .mining-hash .leading-zeros {
            color: #2ea043;
            font-weight: bold;
        }

        .mining-hash .rest {
            color: #8b949e;
        }

        .difficulty-slider {
            width: 100%;
            margin: 15px 0;
        }

        /* Transaction Visualization */
        .transaction {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .tx-icon {
            font-size: 1.5rem;
        }

        .tx-details {
            flex: 1;
        }

        .tx-amount {
            font-weight: bold;
            color: #7ee787;
        }

        .tx-parties {
            font-size: 0.9rem;
            color: #8b949e;
        }

        .tx-hash {
            font-family: 'Consolas', monospace;
            font-size: 0.75rem;
            color: #58a6ff;
        }

        /* Network Visualization */
        .network-container {
            position: relative;
            height: 400px;
            background: #0d1117;
            border-radius: 10px;
            border: 1px solid #30363d;
            overflow: hidden;
        }

        .node {
            position: absolute;
            width: 80px;
            height: 80px;
            background: #21262d;
            border: 2px solid #30363d;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .node:hover {
            transform: scale(1.1);
            border-color: #58a6ff;
        }

        .node.synced {
            border-color: #2ea043;
            box-shadow: 0 0 15px rgba(46, 160, 67, 0.3);
        }

        .node.syncing {
            border-color: #d29922;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(210, 153, 34, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(210, 153, 34, 0); }
        }

        .node-icon {
            font-size: 1.5rem;
        }

        .node-label {
            font-size: 0.7rem;
            color: #8b949e;
            margin-top: 3px;
        }

        /* Comparison Grid */
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .comparison-item {
            background: #0d1117;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #30363d;
        }

        .comparison-item h4 {
            color: #bf91f7;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comparison-item p {
            color: #8b949e;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* Playground Chain */
        .playground-chain {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .add-block-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .add-block-form input {
            flex: 1;
        }

        /* Merkle Tree */
        .merkle-tree {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            padding: 30px;
        }

        .merkle-level {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .merkle-node {
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 10px 15px;
            font-family: 'Consolas', monospace;
            font-size: 0.75rem;
            color: #7ee787;
            text-align: center;
            min-width: 100px;
        }

        .merkle-node.root {
            border-color: #58a6ff;
            background: rgba(56, 139, 253, 0.1);
        }

        .merkle-node.leaf {
            color: #f778ba;
        }

        /* Stats Display */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: #0d1117;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border: 1px solid #30363d;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(90deg, #58a6ff, #bf91f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            color: #8b949e;
            font-size: 0.85rem;
            margin-top: 5px;
        }

        /* Code Block */
        .code-block {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            margin: 15px 0;
        }

        .code-block .keyword {
            color: #ff7b72;
        }

        .code-block .string {
            color: #a5d6ff;
        }

        .code-block .function {
            color: #d2a8ff;
        }

        .code-block .comment {
            color: #8b949e;
        }

        /* Timeline */
        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #30363d;
        }

        .timeline-item {
            position: relative;
            padding: 15px 0;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #58a6ff;
            border: 2px solid #0d1117;
        }

        .timeline-item h4 {
            color: #e6edf3;
            margin-bottom: 5px;
        }

        .timeline-item p {
            color: #8b949e;
            font-size: 0.95rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .nav-tabs {
                padding: 10px;
            }

            .nav-tab {
                padding: 8px 14px;
                font-size: 0.85rem;
            }

            .container {
                padding: 15px;
            }

            .card {
                padding: 20px;
            }

            .hash-comparison {
                grid-template-columns: 1fr;
            }

            .mining-stats {
                grid-template-columns: 1fr;
            }

            .hash-input-section {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>‚õìÔ∏è Understanding Blockchain</h1>
        <p>An interactive journey into how blockchain technology works</p>
    </header>

    <nav class="nav-tabs">
        <button class="nav-tab active" onclick="showSection('overview')">Overview</button>
        <button class="nav-tab" onclick="showSection('hashing')">Hashing</button>
        <button class="nav-tab" onclick="showSection('blocks')">Blocks</button>
        <button class="nav-tab" onclick="showSection('chain')">The Chain</button>
        <button class="nav-tab" onclick="showSection('mining')">Mining</button>
        <button class="nav-tab" onclick="showSection('immutability')">Immutability</button>
        <button class="nav-tab" onclick="showSection('consensus')">Consensus</button>
        <button class="nav-tab" onclick="showSection('transactions')">Transactions</button>
        <button class="nav-tab" onclick="showSection('playground')">Playground</button>
    </nav>

    <div class="container">
        <!-- Overview Section -->
        <section id="overview" class="section active">
            <div class="card">
                <h2>üåü What is Blockchain?</h2>
                <p class="description">
                    A blockchain is a <strong>distributed, immutable ledger</strong> - essentially a database that's shared across many computers, 
                    where once data is written, it cannot be changed without everyone knowing. Think of it as a Google Doc that everyone can 
                    read, but no one can secretly edit past entries.
                </p>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value">2008</div>
                        <div class="stat-label">Bitcoin Whitepaper</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">10K+</div>
                        <div class="stat-label">Cryptocurrencies</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">$1T+</div>
                        <div class="stat-label">Market Cap</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">100M+</div>
                        <div class="stat-label">Users Worldwide</div>
                    </div>
                </div>

                <h3>üîë Core Concepts</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>üîê Cryptographic Hashing</h4>
                        <p>Every piece of data gets a unique "fingerprint" that changes completely if even one character changes.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>üì¶ Blocks</h4>
                        <p>Data is grouped into blocks, each containing transactions and a link to the previous block.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚õìÔ∏è Chain</h4>
                        <p>Blocks link together through hashes, creating an unbreakable chain of history.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚õèÔ∏è Mining</h4>
                        <p>Computers compete to add blocks by solving puzzles, making fraud computationally expensive.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>üåê Decentralization</h4>
                        <p>No single authority controls the chain - thousands of computers hold identical copies.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>ü§ù Consensus</h4>
                        <p>The network agrees on the "true" version of the chain through mathematical rules.</p>
                    </div>
                </div>

                <h3>üìä Traditional Database vs Blockchain</h3>
                <div class="interactive-area">
                    <div class="hash-comparison">
                        <div class="hash-compare-box">
                            <h4 style="color: #f85149;">‚ùå Traditional Database</h4>
                            <ul style="color: #8b949e; margin-top: 10px; padding-left: 20px; line-height: 2;">
                                <li>Centralized control</li>
                                <li>Admin can modify/delete records</li>
                                <li>Single point of failure</li>
                                <li>Trust the institution</li>
                                <li>Fast and efficient</li>
                            </ul>
                        </div>
                        <div class="hash-compare-box">
                            <h4 style="color: #2ea043;">‚úÖ Blockchain</h4>
                            <ul style="color: #8b949e; margin-top: 10px; padding-left: 20px; line-height: 2;">
                                <li>Distributed control</li>
                                <li>Records are immutable</li>
                                <li>No single point of failure</li>
                                <li>Trust the math</li>
                                <li>Slower but secure</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="info-box">
                    <h4>üí° Key Insight</h4>
                    <p>Blockchain solves the "double-spending problem" for digital assets - ensuring you can't copy and spend the same digital money twice, 
                    without needing a bank or central authority to verify transactions.</p>
                </div>
            </div>
        </section>

        <!-- Hashing Section -->
        <section id="hashing" class="section">
            <div class="card">
                <h2>üîê Cryptographic Hashing</h2>
                <p class="description">
                    A hash function takes any input and produces a fixed-size "fingerprint" called a hash. 
                    The same input always produces the same hash, but even a tiny change creates a completely different hash. 
                    This is the foundation of blockchain security.
                </p>

                <div class="info-box">
                    <h4>Properties of a Good Hash Function</h4>
                    <p>
                        <strong>1. Deterministic:</strong> Same input ‚Üí same output, always.<br>
                        <strong>2. Fast:</strong> Quick to compute.<br>
                        <strong>3. One-way:</strong> Can't reverse-engineer the input from the hash.<br>
                        <strong>4. Collision-resistant:</strong> Nearly impossible to find two inputs with the same hash.<br>
                        <strong>5. Avalanche effect:</strong> Small change in input ‚Üí massive change in output.
                    </p>
                </div>

                <div class="interactive-area">
                    <h3>üß™ Try It: Hash Any Text</h3>
                    <div class="hash-demo">
                        <div class="hash-input-section">
                            <input type="text" id="hashInput" placeholder="Type anything..." value="Hello, Blockchain!" oninput="updateHash()">
                            <button class="btn-primary" onclick="updateHash()">Hash It</button>
                        </div>
                        
                        <div class="hash-output">
                            <span class="label">SHA-256 Hash</span>
                            <div class="hash-value" id="hashOutput">-</div>
                        </div>
                        
                        <div style="color: #8b949e; font-size: 0.9rem;">
                            <p>‚ú® Try changing just ONE character and watch the entire hash change!</p>
                        </div>
                    </div>
                </div>

                <h3>üéØ The Avalanche Effect</h3>
                <p class="description">Watch how similar inputs produce completely different hashes:</p>
                
                <div class="interactive-area">
                    <div class="hash-comparison">
                        <div class="hash-compare-box">
                            <div style="margin-bottom: 10px;">
                                <strong>Input 1:</strong> <span id="avalanche1Input">Hello</span>
                            </div>
                            <div class="mini-hash" id="avalanche1Hash">-</div>
                        </div>
                        <div class="hash-compare-box">
                            <div style="margin-bottom: 10px;">
                                <strong>Input 2:</strong> <span id="avalanche2Input">hello</span>
                            </div>
                            <div class="mini-hash" id="avalanche2Hash">-</div>
                        </div>
                    </div>
                    <div style="margin-top: 15px;">
                        <button class="btn-secondary" onclick="showAvalanche('Hello', 'hello')">Hello vs hello</button>
                        <button class="btn-secondary" onclick="showAvalanche('Block 1', 'Block 2')">Block 1 vs Block 2</button>
                        <button class="btn-secondary" onclick="showAvalanche('100 BTC', '100.0 BTC')">100 BTC vs 100.0 BTC</button>
                    </div>
                    <div id="avalancheDiff" style="margin-top: 15px; color: #8b949e;"></div>
                </div>

                <h3>üî¢ Hash as a Number</h3>
                <p class="description">
                    Hashes are actually huge numbers in hexadecimal. This is important for mining - 
                    we can compare hashes to find ones "smaller" than a target.
                </p>
                
                <div class="interactive-area">
                    <div class="code-block">
                        <span class="comment">// A hash like this:</span><br>
                        0000000000000000000abc123def456...<br><br>
                        <span class="comment">// Is actually the number:</span><br>
                        <span class="string">50,123,456,789,012,345,678,901,234...</span><br><br>
                        <span class="comment">// More leading zeros = smaller number!</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Blocks Section -->
        <section id="blocks" class="section">
            <div class="card">
                <h2>üì¶ Anatomy of a Block</h2>
                <p class="description">
                    A block is a container that holds data (usually transactions) along with metadata that links it to the blockchain. 
                    Each block contains a hash of the previous block, creating the "chain" in blockchain.
                </p>

                <div class="interactive-area">
                    <h3>üß™ Interactive Block</h3>
                    <p style="color: #8b949e; margin-bottom: 15px;">Edit the fields and watch how the block's hash changes:</p>
                    
                    <div class="block valid" id="singleBlock">
                        <div class="block-header">
                            <span class="block-number">Block #1</span>
                            <span class="block-status valid" id="singleBlockStatus">‚úì Valid</span>
                        </div>
                        
                        <div class="block-field">
                            <label>Previous Hash:</label>
                            <div class="hash-display prev-hash">0000000000000000000000000000000000000000000000000000000000000000</div>
                        </div>
                        
                        <div class="block-field">
                            <label>Timestamp:</label>
                            <input type="text" id="blockTimestamp" value="2024-01-15 10:30:00" oninput="updateSingleBlock()">
                        </div>
                        
                        <div class="block-field">
                            <label>Data (Transactions):</label>
                            <textarea id="blockData" rows="2" oninput="updateSingleBlock()">Alice sends 5 BTC to Bob</textarea>
                        </div>
                        
                        <div class="block-field">
                            <label>Nonce:</label>
                            <input type="number" id="blockNonce" value="12345" oninput="updateSingleBlock()">
                        </div>
                        
                        <div class="block-field">
                            <label>This Block's Hash:</label>
                            <div class="hash-display" id="singleBlockHash">-</div>
                        </div>
                    </div>
                </div>

                <h3>üìã Block Components Explained</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>üîó Previous Hash</h4>
                        <p>The hash of the block before this one. This creates the "chain" and makes tampering detectable.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚è∞ Timestamp</h4>
                        <p>When the block was created. Helps establish chronological order.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>üìù Data / Transactions</h4>
                        <p>The actual content - usually a list of transactions like "Alice pays Bob 5 BTC."</p>
                    </div>
                    <div class="comparison-item">
                        <h4>üé≤ Nonce</h4>
                        <p>"Number used once" - miners change this to find a valid hash (more on this in Mining).</p>
                    </div>
                    <div class="comparison-item">
                        <h4>üîê Block Hash</h4>
                        <p>Hash of all the above combined. This becomes the "previous hash" for the next block.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>üå≥ Merkle Root</h4>
                        <p>A hash that summarizes all transactions efficiently (covered in advanced topics).</p>
                    </div>
                </div>

                <div class="info-box success">
                    <h4>‚úÖ Why This Structure Matters</h4>
                    <p>If anyone changes ANY data in a block, the hash changes. Since the next block contains this hash, 
                    it becomes invalid too. This cascades through the entire chain, making tampering immediately obvious.</p>
                </div>
            </div>
        </section>

        <!-- Chain Section -->
        <section id="chain" class="section">
            <div class="card">
                <h2>‚õìÔ∏è The Chain: Linking Blocks Together</h2>
                <p class="description">
                    The blockchain gets its name from how blocks connect - each block contains the hash of the previous block, 
                    creating an unbreakable chain. If you change anything in an old block, every block after it becomes invalid.
                </p>

                <div class="interactive-area">
                    <h3>üß™ Interactive Chain</h3>
                    <p style="color: #8b949e; margin-bottom: 15px;">
                        Click on any block to edit it and see how it breaks the chain!
                    </p>
                    
                    <div class="chain-container" id="chainContainer">
                        <!-- Generated by JS -->
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn-primary" onclick="initChain()">Reset Chain</button>
                        <button class="btn-secondary" onclick="addBlockToChain()">Add Block</button>
                    </div>
                </div>

                <h3>üîç How the Links Work</h3>
                <div class="interactive-area">
                    <div class="timeline">
                        <div class="timeline-item">
                            <h4>Block 0 (Genesis Block)</h4>
                            <p>The first block. Previous hash is all zeros since there's no block before it.</p>
                        </div>
                        <div class="timeline-item">
                            <h4>Block 1</h4>
                            <p>Contains the hash of Block 0. If Block 0 changes, this link breaks.</p>
                        </div>
                        <div class="timeline-item">
                            <h4>Block 2</h4>
                            <p>Contains the hash of Block 1. If Block 0 OR Block 1 changes, this breaks.</p>
                        </div>
                        <div class="timeline-item">
                            <h4>Block N...</h4>
                            <p>Each new block depends on ALL previous blocks being unchanged.</p>
                        </div>
                    </div>
                </div>

                <div class="info-box warning">
                    <h4>‚ö†Ô∏è The Security Implication</h4>
                    <p>To tamper with a transaction from 100 blocks ago, an attacker would need to:</p>
                    <ol style="margin-top: 10px; padding-left: 20px; line-height: 2; color: #8b949e;">
                        <li>Change the transaction in block N</li>
                        <li>Recalculate block N's hash</li>
                        <li>Update block N+1's "previous hash" and recalculate its hash</li>
                        <li>Repeat for ALL subsequent blocks (could be thousands!)</li>
                        <li>Do this faster than the rest of the network adds new blocks</li>
                    </ol>
                    <p style="margin-top: 10px;">This is computationally infeasible, making blockchain tamper-proof!</p>
                </div>
            </div>
        </section>

        <!-- Mining Section -->
        <section id="mining" class="section">
            <div class="card">
                <h2>‚õèÔ∏è Mining: Proof of Work</h2>
                <p class="description">
                    Mining is the process of finding a valid hash for a new block. The hash must be below a certain target 
                    (start with a certain number of zeros). Miners try billions of different nonces until they find one that works.
                </p>

                <div class="info-box">
                    <h4>The Mining Challenge</h4>
                    <p>Find a nonce such that: <code>hash(block + nonce)</code> starts with N zeros.<br>
                    More zeros required = harder puzzle = more secure network.</p>
                </div>

                <div class="interactive-area">
                    <h3>üß™ Mine Your Own Block!</h3>
                    
                    <div class="block-field">
                        <label>Block Data:</label>
                        <input type="text" id="miningData" value="Alice sends 10 BTC to Bob">
                    </div>
                    
                    <div class="block-field">
                        <label>Difficulty (leading zeros required): <span id="difficultyValue">4</span></label>
                        <input type="range" id="difficultySlider" min="1" max="6" value="4" class="difficulty-slider" oninput="updateDifficulty()">
                    </div>
                    
                    <div class="mining-stats">
                        <div class="mining-stat">
                            <div class="mining-stat-value" id="miningNonce">0</div>
                            <div class="mining-stat-label">Current Nonce</div>
                        </div>
                        <div class="mining-stat">
                            <div class="mining-stat-value" id="miningAttempts">0</div>
                            <div class="mining-stat-label">Attempts</div>
                        </div>
                        <div class="mining-stat">
                            <div class="mining-stat-value" id="miningTime">0.0s</div>
                            <div class="mining-stat-label">Time</div>
                        </div>
                    </div>
                    
                    <div class="mining-hash" id="miningHash">
                        <span class="rest">Click "Start Mining" to begin...</span>
                    </div>
                    
                    <div style="text-align: center;">
                        <button class="btn-primary" id="mineBtn" onclick="startMining()">‚õèÔ∏è Start Mining</button>
                        <button class="btn-danger" onclick="stopMining()">Stop</button>
                    </div>
                    
                    <div id="miningResult" style="margin-top: 20px; text-align: center;"></div>
                </div>

                <h3>üìä Difficulty Comparison</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>1 Zero (Easy)</h4>
                        <p>~16 attempts on average<br><code>0xxxxx...</code></p>
                    </div>
                    <div class="comparison-item">
                        <h4>4 Zeros (Medium)</h4>
                        <p>~65,000 attempts<br><code>0000xxxxx...</code></p>
                    </div>
                    <div class="comparison-item">
                        <h4>8 Zeros (Hard)</h4>
                        <p>~4.3 billion attempts<br><code>00000000xxxxx...</code></p>
                    </div>
                    <div class="comparison-item">
                        <h4>Bitcoin (19 zeros!)</h4>
                        <p>Trillions of attempts<br>Requires specialized hardware</p>
                    </div>
                </div>

                <div class="info-box success">
                    <h4>üéÅ The Mining Reward</h4>
                    <p>The first miner to find a valid hash gets to add the block and receives:</p>
                    <ul style="margin-top: 10px; padding-left: 20px; color: #8b949e;">
                        <li><strong>Block Reward:</strong> New coins created (Bitcoin: currently 6.25 BTC)</li>
                        <li><strong>Transaction Fees:</strong> Fees from all transactions in the block</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Immutability Section -->
        <section id="immutability" class="section">
            <div class="card">
                <h2>üõ°Ô∏è Immutability: Why Blockchain Can't Be Changed</h2>
                <p class="description">
                    Once data is on the blockchain, it's practically impossible to change. This immutability comes from the 
                    combination of cryptographic hashing, chain structure, and distributed consensus.
                </p>

                <div class="interactive-area">
                    <h3>üß™ Try to Tamper!</h3>
                    <p style="color: #8b949e; margin-bottom: 20px;">
                        This chain has 5 blocks. Try editing Block #2's data and see what happens:
                    </p>
                    
                    <div id="immutableChain">
                        <!-- Generated by JS -->
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn-primary" onclick="initImmutableChain()">Reset Chain</button>
                        <button class="btn-secondary" onclick="revalidateChain()">Revalidate All</button>
                    </div>
                    
                    <div id="tamperResult" class="info-box danger" style="display: none; margin-top: 20px;">
                        <h4>üö® Tampering Detected!</h4>
                        <p id="tamperMessage"></p>
                    </div>
                </div>

                <h3>üîí Layers of Protection</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>1Ô∏è‚É£ Hash Chain</h4>
                        <p>Changing any block invalidates all subsequent blocks. The attacker must recalculate all of them.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>2Ô∏è‚É£ Proof of Work</h4>
                        <p>Recalculating each block requires solving the mining puzzle again - massive computation.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>3Ô∏è‚É£ Distributed Network</h4>
                        <p>Thousands of nodes have copies. The attacker must convince the majority to accept their fake chain.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>4Ô∏è‚É£ Longest Chain Rule</h4>
                        <p>The network trusts the longest valid chain. Attacker must outpace the entire network's computing power.</p>
                    </div>
                </div>

                <h3>üí∞ The 51% Attack</h3>
                <div class="info-box danger">
                    <h4>The Only Way to Cheat</h4>
                    <p>If someone controls more than 50% of the network's computing power, they could theoretically:</p>
                    <ul style="margin-top: 10px; padding-left: 20px; color: #8b949e;">
                        <li>Double-spend their own coins</li>
                        <li>Prevent transactions from being confirmed</li>
                        <li>Reverse recent transactions</li>
                    </ul>
                    <p style="margin-top: 10px;">However, they still <strong>cannot</strong>:</p>
                    <ul style="padding-left: 20px; color: #8b949e;">
                        <li>Steal coins from others</li>
                        <li>Create coins out of thin air</li>
                        <li>Change old, deeply-buried transactions</li>
                    </ul>
                    <p style="margin-top: 10px;">For Bitcoin, a 51% attack would cost billions in hardware and electricity - and would likely crash the price, making it economically irrational.</p>
                </div>
            </div>
        </section>

        <!-- Consensus Section -->
        <section id="consensus" class="section">
            <div class="card">
                <h2>ü§ù Consensus: How Networks Agree</h2>
                <p class="description">
                    With thousands of computers worldwide, how does the network agree on the "true" state of the blockchain? 
                    Consensus mechanisms are the rules that allow decentralized agreement without a central authority.
                </p>

                <div class="interactive-area">
                    <h3>üåê Network Simulation</h3>
                    <p style="color: #8b949e; margin-bottom: 15px;">
                        Watch how nodes reach consensus. Click "Broadcast Block" to see propagation:
                    </p>
                    
                    <div class="network-container" id="networkContainer">
                        <!-- Nodes generated by JS -->
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button class="btn-primary" onclick="broadcastBlock()">üì° Broadcast New Block</button>
                        <button class="btn-secondary" onclick="resetNetwork()">Reset Network</button>
                    </div>
                    
                    <div id="networkStatus" style="margin-top: 15px; text-align: center; color: #8b949e;"></div>
                </div>

                <h3>‚öñÔ∏è Consensus Mechanisms</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>‚õèÔ∏è Proof of Work (PoW)</h4>
                        <p><strong>Used by:</strong> Bitcoin, Litecoin</p>
                        <p style="margin-top: 8px;"><strong>How:</strong> Miners compete to solve puzzles. Most work = most trusted.</p>
                        <p style="margin-top: 8px; color: #2ea043;">‚úÖ Battle-tested, very secure</p>
                        <p style="color: #f85149;">‚ùå High energy use</p>
                    </div>
                    <div class="comparison-item">
                        <h4>ü•© Proof of Stake (PoS)</h4>
                        <p><strong>Used by:</strong> Ethereum 2.0, Cardano</p>
                        <p style="margin-top: 8px;"><strong>How:</strong> Validators stake coins as collateral. More stake = more likely to validate.</p>
                        <p style="margin-top: 8px; color: #2ea043;">‚úÖ Energy efficient</p>
                        <p style="color: #f85149;">‚ùå "Rich get richer" concerns</p>
                    </div>
                    <div class="comparison-item">
                        <h4>üë• Delegated PoS (DPoS)</h4>
                        <p><strong>Used by:</strong> EOS, Tron</p>
                        <p style="margin-top: 8px;"><strong>How:</strong> Token holders vote for delegates who validate blocks.</p>
                        <p style="margin-top: 8px; color: #2ea043;">‚úÖ Fast, scalable</p>
                        <p style="color: #f85149;">‚ùå More centralized</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚è±Ô∏è Proof of History (PoH)</h4>
                        <p><strong>Used by:</strong> Solana</p>
                        <p style="margin-top: 8px;"><strong>How:</strong> Cryptographic timestamps prove time passage.</p>
                        <p style="margin-top: 8px; color: #2ea043;">‚úÖ Very fast (65k TPS)</p>
                        <p style="color: #f85149;">‚ùå Newer, less proven</p>
                    </div>
                </div>

                <h3>üç¥ What Happens During Forks?</h3>
                <div class="interactive-area">
                    <p class="description">
                        Sometimes the network temporarily disagrees - two miners find valid blocks at nearly the same time. 
                        This creates a "fork" that resolves when one chain grows longer.
                    </p>
                    
                    <div class="code-block">
<span class="comment">// Two miners find blocks at the same time:</span>

Block 99 ‚îÄ‚îÄ‚îÄ Block 100a (Miner A)
         ‚îî‚îÄ‚îÄ Block 100b (Miner B)

<span class="comment">// Network splits temporarily, but then...</span>

Block 99 ‚îÄ‚îÄ‚îÄ Block 100a ‚îÄ‚îÄ‚îÄ Block 101 (Someone built on A)
         ‚îî‚îÄ‚îÄ Block 100b (Orphaned - abandoned)

<span class="comment">// The longest chain wins! Block 100b becomes an "orphan"</span>
                    </div>
                </div>

                <div class="info-box">
                    <h4>üî¢ Confirmation Count</h4>
                    <p>This is why exchanges wait for multiple "confirmations" before crediting your deposit. 
                    Each new block on top of your transaction makes it exponentially harder to reverse.</p>
                    <p style="margin-top: 10px;">
                        <strong>1 confirmation:</strong> Probably safe<br>
                        <strong>3 confirmations:</strong> Very likely permanent<br>
                        <strong>6 confirmations:</strong> Bitcoin standard - effectively irreversible
                    </p>
                </div>
            </div>
        </section>

        <!-- Transactions Section -->
        <section id="transactions" class="section">
            <div class="card">
                <h2>üí∏ Transactions: How Value Moves</h2>
                <p class="description">
                    Transactions are the actual data stored in blocks. They record the transfer of value (cryptocurrency) 
                    from one address to another, secured by cryptographic signatures.
                </p>

                <div class="interactive-area">
                    <h3>üß™ Create a Transaction</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="block-field">
                            <label>From Address:</label>
                            <input type="text" id="txFrom" value="1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa" oninput="updateTransaction()">
                        </div>
                        <div class="block-field">
                            <label>To Address:</label>
                            <input type="text" id="txTo" value="3J98t1WpEZ73CNmQviecrnyiWrnqRhWNLy" oninput="updateTransaction()">
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div class="block-field">
                            <label>Amount (BTC):</label>
                            <input type="number" id="txAmount" value="0.5" step="0.01" oninput="updateTransaction()">
                        </div>
                        <div class="block-field">
                            <label>Fee (BTC):</label>
                            <input type="number" id="txFee" value="0.0001" step="0.0001" oninput="updateTransaction()">
                        </div>
                    </div>
                    
                    <div class="block-field">
                        <label>Transaction Hash:</label>
                        <div class="hash-display" id="txHash">-</div>
                    </div>
                    
                    <button class="btn-primary" onclick="signTransaction()" style="margin-top: 15px;">‚úçÔ∏è Sign Transaction</button>
                    
                    <div id="txSignature" style="display: none; margin-top: 15px;">
                        <div class="block-field">
                            <label>Digital Signature:</label>
                            <div class="hash-display" id="txSig" style="color: #d29922;">-</div>
                        </div>
                    </div>
                </div>

                <h3>üìã Transaction Lifecycle</h3>
                <div class="timeline">
                    <div class="timeline-item">
                        <h4>1. Created</h4>
                        <p>You specify the recipient and amount, then sign with your private key.</p>
                    </div>
                    <div class="timeline-item">
                        <h4>2. Broadcast</h4>
                        <p>Transaction is sent to the network and enters the "mempool" (waiting area).</p>
                    </div>
                    <div class="timeline-item">
                        <h4>3. Validated</h4>
                        <p>Nodes verify: Do you have the funds? Is the signature valid?</p>
                    </div>
                    <div class="timeline-item">
                        <h4>4. Included in Block</h4>
                        <p>A miner picks your transaction (usually prioritizing higher fees).</p>
                    </div>
                    <div class="timeline-item">
                        <h4>5. Confirmed</h4>
                        <p>The block is mined and added to the chain. More blocks = more confirmations.</p>
                    </div>
                </div>

                <h3>üîê Public/Private Keys</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>üîë Private Key</h4>
                        <p>A secret number that proves ownership. NEVER share this!</p>
                        <div class="code-block" style="margin-top: 10px; font-size: 0.75rem;">
                            5HueCGU8rMjxEXxiPuD5BDku4MkFqeZyd4dZ1jvhTVqvbTLvyTJ
                        </div>
                    </div>
                    <div class="comparison-item">
                        <h4>üì¨ Public Key / Address</h4>
                        <p>Derived from private key. Safe to share - this is where people send you funds.</p>
                        <div class="code-block" style="margin-top: 10px; font-size: 0.75rem;">
                            1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa
                        </div>
                    </div>
                </div>

                <div class="info-box warning">
                    <h4>‚ö†Ô∏è Not Your Keys, Not Your Coins</h4>
                    <p>If you keep crypto on an exchange, THEY hold the private keys. If the exchange is hacked or goes bankrupt, your funds could be lost. 
                    For large amounts, use a hardware wallet where YOU control the keys.</p>
                </div>
            </div>
        </section>

        <!-- Playground Section -->
        <section id="playground" class="section">
            <div class="card">
                <h2>üéÆ Playground: Build Your Own Blockchain</h2>
                <p class="description">
                    Now it's your turn! Create blocks, mine them, and see how a real blockchain grows.
                </p>

                <div class="interactive-area">
                    <h3>‚õìÔ∏è Your Blockchain</h3>
                    
                    <div class="add-block-form">
                        <input type="text" id="playgroundData" placeholder="Enter block data (e.g., 'Alice pays Bob 5 BTC')">
                        <button class="btn-primary" onclick="addPlaygroundBlock()">‚ûï Add Block</button>
                    </div>
                    
                    <div class="block-field">
                        <label>Mining Difficulty: <span id="playgroundDiffValue">3</span> zeros</label>
                        <input type="range" id="playgroundDiff" min="1" max="5" value="3" oninput="document.getElementById('playgroundDiffValue').textContent = this.value">
                    </div>
                    
                    <div id="playgroundChain" class="playground-chain">
                        <!-- Generated by JS -->
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="btn-danger" onclick="resetPlayground()">üóëÔ∏è Reset Blockchain</button>
                        <button class="btn-secondary" onclick="exportPlayground()">üì§ Export JSON</button>
                    </div>
                </div>

                <h3>üìä Blockchain Stats</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="playgroundBlockCount">1</div>
                        <div class="stat-label">Total Blocks</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="playgroundTotalMines">0</div>
                        <div class="stat-label">Total Mining Attempts</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="playgroundChainValid">‚úì</div>
                        <div class="stat-label">Chain Valid</div>
                    </div>
                </div>

                <h3>üéì What You've Learned</h3>
                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>‚úÖ Hashing</h4>
                        <p>Data fingerprints that change completely with any modification.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚úÖ Blocks</h4>
                        <p>Containers holding data, timestamps, nonces, and hash links.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚úÖ Chaining</h4>
                        <p>Each block contains the previous hash, creating immutable history.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚úÖ Mining</h4>
                        <p>Finding a nonce that produces a hash with required leading zeros.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚úÖ Immutability</h4>
                        <p>Changing old data breaks the chain and is computationally infeasible.</p>
                    </div>
                    <div class="comparison-item">
                        <h4>‚úÖ Consensus</h4>
                        <p>Networks agree on truth through mathematical rules, not central authority.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // ==================== NAVIGATION ====================
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');

            // Initialize section-specific content
            if (sectionId === 'hashing') {
                updateHash();
                showAvalanche('Hello', 'hello');
            }
            if (sectionId === 'blocks') updateSingleBlock();
            if (sectionId === 'chain') initChain();
            if (sectionId === 'immutability') initImmutableChain();
            if (sectionId === 'consensus') initNetwork();
            if (sectionId === 'transactions') updateTransaction();
            if (sectionId === 'playground') initPlayground();
        }

        // ==================== HASHING ====================
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        // Simple hash for synchronous operations (not cryptographically secure, just for demo)
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            // Convert to hex-like string
            const hex = Math.abs(hash).toString(16).padStart(8, '0');
            // Extend it to look like SHA-256
            let result = '';
            for (let i = 0; i < 8; i++) {
                result += ((parseInt(hex, 16) * (i + 1)) >>> 0).toString(16).padStart(8, '0');
            }
            return result.substring(0, 64);
        }

        async function updateHash() {
            const input = document.getElementById('hashInput').value;
            const hash = await sha256(input);
            document.getElementById('hashOutput').textContent = hash;
        }

        async function showAvalanche(input1, input2) {
            document.getElementById('avalanche1Input').textContent = input1;
            document.getElementById('avalanche2Input').textContent = input2;
            
            const hash1 = await sha256(input1);
            const hash2 = await sha256(input2);
            
            document.getElementById('avalanche1Hash').textContent = hash1;
            document.getElementById('avalanche2Hash').textContent = hash2;
            
            // Calculate difference
            let diff = 0;
            for (let i = 0; i < hash1.length; i++) {
                if (hash1[i] !== hash2[i]) diff++;
            }
            const percentDiff = ((diff / hash1.length) * 100).toFixed(1);
            
            document.getElementById('avalancheDiff').innerHTML = 
                `<strong>${diff}</strong> of ${hash1.length} characters are different (<strong>${percentDiff}%</strong> change from a tiny input modification!)`;
        }

        // ==================== SINGLE BLOCK ====================
        async function updateSingleBlock() {
            const timestamp = document.getElementById('blockTimestamp').value;
            const data = document.getElementById('blockData').value;
            const nonce = document.getElementById('blockNonce').value;
            const prevHash = '0000000000000000000000000000000000000000000000000000000000000000';
            
            const blockContent = prevHash + timestamp + data + nonce;
            const hash = await sha256(blockContent);
            
            document.getElementById('singleBlockHash').textContent = hash;
        }

        // ==================== CHAIN VISUALIZATION ====================
        let chain = [];

        async function createBlock(index, data, previousHash) {
            const timestamp = new Date().toISOString();
            let nonce = 0;
            let hash = '';
            
            // Simple mining (find hash starting with "00")
            do {
                nonce++;
                const blockContent = index + previousHash + timestamp + data + nonce;
                hash = simpleHash(blockContent);
            } while (!hash.startsWith('00') && nonce < 10000);
            
            return {
                index,
                timestamp,
                data,
                previousHash,
                nonce,
                hash
            };
        }

        async function initChain() {
            chain = [];
            
            // Genesis block
            const genesis = await createBlock(0, 'Genesis Block', '0'.repeat(64));
            chain.push(genesis);
            
            // Add a couple more blocks
            const block1 = await createBlock(1, 'Alice sends 10 BTC to Bob', genesis.hash);
            chain.push(block1);
            
            const block2 = await createBlock(2, 'Bob sends 5 BTC to Charlie', block1.hash);
            chain.push(block2);
            
            renderChain();
        }

        function renderChain() {
            const container = document.getElementById('chainContainer');
            container.innerHTML = '';
            
            chain.forEach((block, i) => {
                const isValid = validateBlock(block, i);
                const isGenesis = i === 0;
                
                if (i > 0) {
                    const link = document.createElement('span');
                    link.className = `chain-link ${isValid ? 'valid' : 'invalid'}`;
                    link.textContent = '‚Üí';
                    container.appendChild(link);
                }
                
                const blockEl = document.createElement('div');
                blockEl.className = `chain-block ${isValid ? 'valid' : 'invalid'} ${isGenesis ? 'genesis' : ''}`;
                blockEl.innerHTML = `
                    <div style="font-weight: bold; color: #58a6ff; margin-bottom: 10px;">
                        ${isGenesis ? 'üåü Genesis' : `Block #${block.index}`}
                    </div>
                    <div style="font-size: 0.85rem; color: #8b949e; margin-bottom: 8px;">
                        ${block.data.substring(0, 25)}${block.data.length > 25 ? '...' : ''}
                    </div>
                    <div style="font-size: 0.7rem; margin-bottom: 5px;">
                        <span style="color: #8b949e;">Prev:</span>
                        <span class="mini-hash prev">${block.previousHash.substring(0, 8)}...</span>
                    </div>
                    <div style="font-size: 0.7rem;">
                        <span style="color: #8b949e;">Hash:</span>
                        <span class="mini-hash">${block.hash.substring(0, 8)}...</span>
                    </div>
                `;
                container.appendChild(blockEl);
            });
        }

        function validateBlock(block, index) {
            if (index === 0) return true;
            return block.previousHash === chain[index - 1].hash;
        }

        async function addBlockToChain() {
            const lastBlock = chain[chain.length - 1];
            const newBlock = await createBlock(
                chain.length,
                `Transaction ${chain.length}`,
                lastBlock.hash
            );
            chain.push(newBlock);
            renderChain();
        }

        // ==================== IMMUTABILITY DEMO ====================
        let immutableChain = [];

        async function initImmutableChain() {
            immutableChain = [];
            document.getElementById('tamperResult').style.display = 'none';
            
            const genesis = await createBlock(0, 'Genesis Block', '0'.repeat(64));
            immutableChain.push(genesis);
            
            for (let i = 1; i <= 4; i++) {
                const prevHash = immutableChain[i - 1].hash;
                const block = await createBlock(i, `Block ${i} data - Transaction records`, prevHash);
                immutableChain.push(block);
            }
            
            renderImmutableChain();
        }

        function renderImmutableChain() {
            const container = document.getElementById('immutableChain');
            container.innerHTML = '';
            
            immutableChain.forEach((block, i) => {
                const isValid = i === 0 || block.previousHash === immutableChain[i - 1].hash;
                
                const blockEl = document.createElement('div');
                blockEl.className = `block ${isValid ? 'valid' : 'invalid'}`;
                blockEl.innerHTML = `
                    <div class="block-header">
                        <span class="block-number">${i === 0 ? 'üåü Genesis' : `Block #${block.index}`}</span>
                        <span class="block-status ${isValid ? 'valid' : 'invalid'}">${isValid ? '‚úì Valid' : '‚úó Invalid'}</span>
                    </div>
                    <div class="block-field">
                        <label>Data:</label>
                        <input type="text" value="${block.data}" onchange="tamperBlock(${i}, this.value)" ${i === 0 ? 'disabled' : ''}>
                    </div>
                    <div class="block-field">
                        <label>Previous Hash:</label>
                        <div class="hash-display prev-hash" style="font-size: 0.8rem;">${block.previousHash.substring(0, 32)}...</div>
                    </div>
                    <div class="block-field">
                        <label>This Hash:</label>
                        <div class="hash-display" style="font-size: 0.8rem;">${block.hash.substring(0, 32)}...</div>
                    </div>
                `;
                container.appendChild(blockEl);
            });
        }

        function tamperBlock(index, newData) {
            // Change the data
            immutableChain[index].data = newData;
            
            // Recalculate this block's hash
            const block = immutableChain[index];
            const blockContent = block.index + block.previousHash + block.timestamp + newData + block.nonce;
            block.hash = simpleHash(blockContent);
            
            // Show tampering result
            document.getElementById('tamperResult').style.display = 'block';
            
            // Count invalid blocks
            let invalidCount = 0;
            for (let i = index + 1; i < immutableChain.length; i++) {
                if (immutableChain[i].previousHash !== immutableChain[i - 1].hash) {
                    invalidCount++;
                }
            }
            
            document.getElementById('tamperMessage').innerHTML = `
                You modified Block #${index}. Its hash changed, but Block #${index + 1}'s "previous hash" still points to the old hash!
                <br><br>
                <strong>${invalidCount} block(s)</strong> are now invalid. To successfully tamper, you'd need to re-mine all ${invalidCount} blocks 
                faster than the entire network mines new ones. This is computationally infeasible!
            `;
            
            renderImmutableChain();
        }

        function revalidateChain() {
            initImmutableChain();
        }

        // ==================== MINING ====================
        let miningInterval = null;
        let miningStartTime = 0;
        let miningAttempts = 0;

        function updateDifficulty() {
            document.getElementById('difficultyValue').textContent = 
                document.getElementById('difficultySlider').value;
        }

        function startMining() {
            if (miningInterval) return;
            
            const data = document.getElementById('miningData').value;
            const difficulty = parseInt(document.getElementById('difficultySlider').value);
            const target = '0'.repeat(difficulty);
            
            miningAttempts = 0;
            miningStartTime = Date.now();
            document.getElementById('miningResult').innerHTML = '';
            document.getElementById('mineBtn').disabled = true;
            
            let nonce = 0;
            
            miningInterval = setInterval(() => {
                // Try multiple nonces per interval for speed
                for (let i = 0; i < 100; i++) {
                    nonce++;
                    miningAttempts++;
                    
                    const hash = simpleHash(data + nonce);
                    
                    // Update display
                    document.getElementById('miningNonce').textContent = nonce;
                    document.getElementById('miningAttempts').textContent = miningAttempts.toLocaleString();
                    document.getElementById('miningTime').textContent = 
                        ((Date.now() - miningStartTime) / 1000).toFixed(1) + 's';
                    
                    // Color the hash
                    const leadingZeros = hash.match(/^0*/)[0].length;
                    document.getElementById('miningHash').innerHTML = 
                        `<span class="leading-zeros">${hash.substring(0, leadingZeros)}</span><span class="rest">${hash.substring(leadingZeros)}</span>`;
                    
                    // Check if we found it
                    if (hash.startsWith(target)) {
                        stopMining();
                        document.getElementById('miningResult').innerHTML = `
                            <div class="info-box success">
                                <h4>üéâ Block Mined Successfully!</h4>
                                <p>Found valid hash after <strong>${miningAttempts.toLocaleString()}</strong> attempts in 
                                <strong>${((Date.now() - miningStartTime) / 1000).toFixed(2)}s</strong></p>
                                <p style="margin-top: 10px;">Winning nonce: <strong>${nonce}</strong></p>
                            </div>
                        `;
                        return;
                    }
                }
            }, 10);
        }

        function stopMining() {
            if (miningInterval) {
                clearInterval(miningInterval);
                miningInterval = null;
            }
            document.getElementById('mineBtn').disabled = false;
        }

        // ==================== NETWORK / CONSENSUS ====================
        let nodes = [];

        function initNetwork() {
            const container = document.getElementById('networkContainer');
            const width = container.offsetWidth;
            const height = container.offsetHeight;
            
            // Create nodes in a circle
            nodes = [];
            const nodeCount = 8;
            const centerX = width / 2;
            const centerY = height / 2;
            const radius = Math.min(width, height) * 0.35;
            
            for (let i = 0; i < nodeCount; i++) {
                const angle = (i / nodeCount) * Math.PI * 2 - Math.PI / 2;
                nodes.push({
                    id: i,
                    x: centerX + Math.cos(angle) * radius - 40,
                    y: centerY + Math.sin(angle) * radius - 40,
                    synced: true,
                    blockHeight: 100
                });
            }
            
            renderNetwork();
        }

        function renderNetwork() {
            const container = document.getElementById('networkContainer');
            container.innerHTML = nodes.map(node => `
                <div class="node ${node.synced ? 'synced' : 'syncing'}" 
                     style="left: ${node.x}px; top: ${node.y}px;"
                     onclick="showNodeInfo(${node.id})">
                    <span class="node-icon">üíª</span>
                    <span class="node-label">Node ${node.id}</span>
                </div>
            `).join('');
            
            document.getElementById('networkStatus').textContent = 
                `All ${nodes.length} nodes synced at block height ${nodes[0].blockHeight}`;
        }

        async function broadcastBlock() {
            // Pick a random node to "find" the block
            const minerIndex = Math.floor(Math.random() * nodes.length);
            
            // Set all nodes to syncing except miner
            nodes.forEach((node, i) => {
                if (i !== minerIndex) node.synced = false;
            });
            nodes[minerIndex].blockHeight++;
            renderNetwork();
            
            document.getElementById('networkStatus').textContent = 
                `Node ${minerIndex} found block ${nodes[minerIndex].blockHeight}! Broadcasting...`;
            
            // Gradually sync other nodes
            for (let i = 0; i < nodes.length; i++) {
                if (i !== minerIndex) {
                    await new Promise(resolve => setTimeout(resolve, 300 + Math.random() * 500));
                    nodes[i].synced = true;
                    nodes[i].blockHeight = nodes[minerIndex].blockHeight;
                    renderNetwork();
                    document.getElementById('networkStatus').textContent = 
                        `Node ${i} synced! (${nodes.filter(n => n.synced).length}/${nodes.length} nodes)`;
                }
            }
            
            document.getElementById('networkStatus').textContent = 
                `‚úÖ Consensus reached! All nodes at block ${nodes[0].blockHeight}`;
        }

        function resetNetwork() {
            initNetwork();
        }

        function showNodeInfo(id) {
            const node = nodes[id];
            alert(`Node ${id}\nBlock Height: ${node.blockHeight}\nStatus: ${node.synced ? 'Synced' : 'Syncing'}`);
        }

        // ==================== TRANSACTIONS ====================
        async function updateTransaction() {
            const from = document.getElementById('txFrom').value;
            const to = document.getElementById('txTo').value;
            const amount = document.getElementById('txAmount').value;
            const fee = document.getElementById('txFee').value;
            
            const txData = from + to + amount + fee + Date.now();
            const hash = await sha256(txData);
            
            document.getElementById('txHash').textContent = hash;
            document.getElementById('txSignature').style.display = 'none';
        }

        async function signTransaction() {
            const txHash = document.getElementById('txHash').textContent;
            // Simulate signature (in reality, this uses private key cryptography)
            const signature = await sha256('PRIVATE_KEY_' + txHash);
            
            document.getElementById('txSignature').style.display = 'block';
            document.getElementById('txSig').textContent = signature;
        }

        // ==================== PLAYGROUND ====================
        let playgroundChain = [];
        let totalMiningAttempts = 0;

        async function initPlayground() {
            if (playgroundChain.length === 0) {
                const genesis = {
                    index: 0,
                    timestamp: new Date().toISOString(),
                    data: 'Genesis Block',
                    previousHash: '0'.repeat(64),
                    nonce: 0,
                    hash: simpleHash('genesis'),
                    miningAttempts: 0
                };
                playgroundChain.push(genesis);
                renderPlayground();
            }
        }

        async function addPlaygroundBlock() {
            const data = document.getElementById('playgroundData').value;
            if (!data.trim()) {
                alert('Please enter some data for the block!');
                return;
            }
            
            const difficulty = parseInt(document.getElementById('playgroundDiff').value);
            const target = '0'.repeat(difficulty);
            const prevBlock = playgroundChain[playgroundChain.length - 1];
            
            let nonce = 0;
            let hash = '';
            let attempts = 0;
            
            // Mine the block
            do {
                nonce++;
                attempts++;
                const blockContent = playgroundChain.length + prevBlock.hash + data + nonce;
                hash = simpleHash(blockContent);
            } while (!hash.startsWith(target) && nonce < 1000000);
            
            totalMiningAttempts += attempts;
            
            const newBlock = {
                index: playgroundChain.length,
                timestamp: new Date().toISOString(),
                data: data,
                previousHash: prevBlock.hash,
                nonce: nonce,
                hash: hash,
                miningAttempts: attempts
            };
            
            playgroundChain.push(newBlock);
            document.getElementById('playgroundData').value = '';
            renderPlayground();
        }

        function renderPlayground() {
            const container = document.getElementById('playgroundChain');
            
            container.innerHTML = playgroundChain.map((block, i) => `
                <div class="block valid">
                    <div class="block-header">
                        <span class="block-number">${i === 0 ? 'üåü Genesis' : `Block #${block.index}`}</span>
                        <span class="block-status valid">‚úì Valid</span>
                    </div>
                    <div class="block-field">
                        <label>Data:</label>
                        <div style="padding: 10px; background: #0d1117; border-radius: 6px; color: #e6edf3;">${block.data}</div>
                    </div>
                    <div class="block-field">
                        <label>Nonce:</label>
                        <div style="color: #d29922;">${block.nonce.toLocaleString()} ${block.miningAttempts ? `(found in ${block.miningAttempts.toLocaleString()} attempts)` : ''}</div>
                    </div>
                    <div class="block-field">
                        <label>Previous Hash:</label>
                        <div class="hash-display prev-hash" style="font-size: 0.8rem;">${block.previousHash}</div>
                    </div>
                    <div class="block-field">
                        <label>Block Hash:</label>
                        <div class="hash-display" style="font-size: 0.8rem;">${block.hash}</div>
                    </div>
                </div>
            `).join('');
            
            // Update stats
            document.getElementById('playgroundBlockCount').textContent = playgroundChain.length;
            document.getElementById('playgroundTotalMines').textContent = totalMiningAttempts.toLocaleString();
            document.getElementById('playgroundChainValid').textContent = '‚úì';
            document.getElementById('playgroundChainValid').style.color = '#2ea043';
        }

        function resetPlayground() {
            playgroundChain = [];
            totalMiningAttempts = 0;
            initPlayground();
        }

        function exportPlayground() {
            const json = JSON.stringify(playgroundChain, null, 2);
            const blob = new Blob([json], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'my-blockchain.json';
            a.click();
        }

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', () => {
            updateHash();
            showAvalanche('Hello', 'hello');
        });
    </script>
</body>
</html>
